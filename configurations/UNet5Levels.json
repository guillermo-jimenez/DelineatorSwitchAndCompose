{
    "root_directory": "/media/guille/DADES/DADES/Delineator/Databases/",
    "save_directory": "/media/guille/DADES/DADES/Delineator/TrainedModels/",
    "device": "cuda",
    "seed": 123456,
    "resume": false,
    "input_shape": 1024,
    "iterator": "tqdm",
    "epochs": 100,
    "sampler": {
        "shuffle": true
    },
    "dataset": {
        "length": 65536,
        "N": 2048,
        "noise": 0.005,
        "proba_no_P": 0.25,
        "proba_no_QRS": 0.01,
        "proba_no_PQ": 0.15,
        "proba_no_ST": 0.15,
        "proba_same_morph": 0.2,
        "proba_elevation": 0.2,
        "proba_interpolation": 0.2,
        "proba_mixup": 0.25,
        "mixup_alpha": 1.0,
        "mixup_beta": 1.0,
        "proba_TV": 0.05,
        "proba_AF": 0.05,
        "proba_tachy": 0.05,
        "tachy_maxlen": 10,
        "add_baseline_wander": true,
        "amplitude_std": 0.25,
        "interp_std": 0.25,
        "smoothing_window": 51,
        "QRS_ampl_low_thres": 0.1,
        "QRS_ampl_high_thres": 1.15,
        "scaling_metric": "utils.signal.abs_max",
        "return_beats": false,
        "labels_as_masks": true
    },
    "loader": {
        "batch_size": 256,
        "num_workers": 4,
        "pin_memory": true
    },
    "optimizer": {
        "class": "Adam",
        "arguments": {
            "lr": 0.001
        }
    },
    "scheduler": {
        "class": "ReduceLROnPlateau",
        "arguments": {
            "factor": 0.1,
            "patience": 20
        }
    },
    "augmentation": {
        "class": "RandomChoice",
        "arguments": {},
        "types": {
            "AdditiveWhiteGaussianNoise": [
                20,
                0.01
            ],
            "PowerlineNoise": [
                20,
                500,
                50.0
            ],
            "BaselineNoise": [
                -5,
                500,
                0.5
            ],
            "ChangeAmplitude": [
                0.01
            ],
            "SegmentationErrors": [
                10
            ]
        }
    },
    "loss": [
        {
            "class": "CrossEntropyLoss",
            "mapping": [
                "sigmoid",
                "input_0"
            ],
            "weight": 5
        }
    ],
    "model": {
        "type": "graph",
        "functions": [
            {
                "name": "forward",
                "inputs": [
                    "encoder_lvl1"
                ],
                "outputs": [
                    "sigmoid"
                ]
            }
        ],
        "edges": [
            ["encoder_lvl1", "encoder_avgpool1"],
            ["encoder_avgpool1", "encoder_lvl2"],
            ["encoder_lvl2", "encoder_avgpool2"],
            ["encoder_avgpool2", "encoder_lvl3"],
            ["encoder_lvl3", "encoder_avgpool3"],
            ["encoder_avgpool3", "encoder_lvl4"],
            ["encoder_lvl4", "encoder_avgpool4"],
            ["encoder_avgpool4", "encoder_lvl5"],
            ["encoder_lvl5", "decoder_upsample5"],
            ["decoder_upsample5", ["decoder_upsample5","encoder_lvl4"]],
            ["encoder_lvl4", ["decoder_upsample5","encoder_lvl4"]],
            [["decoder_upsample5","encoder_lvl4"],"decoder_concat4"],
            ["decoder_concat4", "decoder_lvl4"],
            ["decoder_lvl4", "decoder_upsample4"],
            ["decoder_upsample4", ["decoder_upsample4","encoder_lvl3"]],
            ["encoder_lvl3", ["decoder_upsample4","encoder_lvl3"]],
            [["decoder_upsample4","encoder_lvl3"],"decoder_concat3"],
            ["decoder_concat3", "decoder_lvl3"],
            ["decoder_lvl3", "decoder_upsample3"],
            ["decoder_upsample3", ["decoder_upsample3","encoder_lvl2"]],
            ["encoder_lvl2", ["decoder_upsample3","encoder_lvl2"]],
            [["decoder_upsample3","encoder_lvl2"],"decoder_concat2"],
            ["decoder_concat2", "decoder_lvl2"],
            ["decoder_lvl2", "decoder_upsample2"],
            ["decoder_upsample2", ["decoder_upsample2","encoder_lvl1"]],
            ["encoder_lvl1", ["decoder_upsample2","encoder_lvl1"]],
            [["decoder_upsample2","encoder_lvl1"],"decoder_concat1"],
            ["decoder_concat1", "decoder_lvl1"],
            ["decoder_lvl1", "sigmoid"]
        ],
        "nodes": [
            {
                "id": "encoder_lvl1",
                "class": "CNN",
                "operation": {
                    "class": "SeparableConv1d"
                },
                "arguments": {
                    "channels": [
                        1,
                        16,
                        16
                    ],
                    "regularization": [
                        {
                            "class": "LeakyReLU"
                        },
                        {
                            "class": "BatchNorm1d",
                            "arguments": {
                                "num_features": "update"
                            }
                        },
                        {
                            "class": "Dropout1d",
                            "arguments": {
                                "p": 0.25
                            }
                        }
                    ]
                }
            },
            {
                "id": "encoder_avgpool1",
                "class": "AvgPool1d",
                "arguments": {
                    "kernel_size": 2
                }
            },
            {
                "id": "encoder_lvl2",
                "class": "CNN",
                "operation": {
                    "class": "SeparableConv1d"
                },
                "arguments": {
                    "channels": [
                        16,
                        32,
                        32
                    ],
                    "regularization": [
                        {
                            "class": "LeakyReLU"
                        },
                        {
                            "class": "BatchNorm1d",
                            "arguments": {
                                "num_features": "update"
                            }
                        },
                        {
                            "class": "Dropout1d",
                            "arguments": {
                                "p": 0.25
                            }
                        }
                    ]
                }
            },
            {
                "id": "encoder_avgpool2",
                "class": "AvgPool1d",
                "arguments": {
                    "kernel_size": 2
                }
            },
            {
                "id": "encoder_lvl3",
                "class": "CNN",
                "operation": {
                    "class": "SeparableConv1d"
                },
                "arguments": {
                    "channels": [
                        32,
                        64,
                        64
                    ],
                    "regularization": [
                        {
                            "class": "LeakyReLU"
                        },
                        {
                            "class": "BatchNorm1d",
                            "arguments": {
                                "num_features": "update"
                            }
                        },
                        {
                            "class": "Dropout1d",
                            "arguments": {
                                "p": 0.25
                            }
                        }
                    ]
                }
            },
            {
                "id": "encoder_avgpool3",
                "class": "AvgPool1d",
                "arguments": {
                    "kernel_size": 2
                }
            },
            {
                "id": "encoder_lvl4",
                "class": "CNN",
                "operation": {
                    "class": "SeparableConv1d"
                },
                "arguments": {
                    "channels": [
                        64,
                        128,
                        128
                    ],
                    "regularization": [
                        {
                            "class": "LeakyReLU"
                        },
                        {
                            "class": "BatchNorm1d",
                            "arguments": {
                                "num_features": "update"
                            }
                        },
                        {
                            "class": "Dropout1d",
                            "arguments": {
                                "p": 0.25
                            }
                        }
                    ]
                }
            },
            {
                "id": "encoder_avgpool4",
                "class": "AvgPool1d",
                "arguments": {
                    "kernel_size": 2
                }
            },
            {
                "id": "encoder_lvl5",
                "class": "CNN",
                "operation": {
                    "class": "SeparableConv1d"
                },
                "arguments": {
                    "channels": [
                        128,
                        256,
                        256
                    ],
                    "regularization": [
                        {
                            "class": "LeakyReLU"
                        },
                        {
                            "class": "BatchNorm1d",
                            "arguments": {
                                "num_features": "update"
                            }
                        },
                        {
                            "class": "Dropout1d",
                            "arguments": {
                                "p": 0.25
                            }
                        }
                    ]
                }
            },
            {
                "id": "decoder_upsample5",
                "class": "Upsample",
                "arguments": {
                    "scale_factor": 2
                }
            },
            {
                "id": "decoder_concat4",
                "class": "Concatenate"
            },
            {
                "id": "decoder_lvl4",
                "class": "CNN",
                "operation": {
                    "class": "SeparableConv1d"
                },
                "arguments": {
                    "channels": [
                        384,
                        128,
                        128
                    ],
                    "regularization": [
                        {
                            "class": "LeakyReLU"
                        },
                        {
                            "class": "BatchNorm1d",
                            "arguments": {
                                "num_features": "update"
                            }
                        },
                        {
                            "class": "Dropout1d",
                            "arguments": {
                                "p": 0.25
                            }
                        }
                    ]
                }
            },
            {
                "id": "decoder_upsample4",
                "class": "Upsample",
                "arguments": {
                    "scale_factor": 2
                }
            },
            {
                "id": "decoder_concat3",
                "class": "Concatenate"
            },
            {
                "id": "decoder_lvl3",
                "class": "CNN",
                "operation": {
                    "class": "SeparableConv1d"
                },
                "arguments": {
                    "channels": [
                        192,
                        64,
                        64
                    ],
                    "regularization": [
                        {
                            "class": "LeakyReLU"
                        },
                        {
                            "class": "BatchNorm1d",
                            "arguments": {
                                "num_features": "update"
                            }
                        },
                        {
                            "class": "Dropout1d",
                            "arguments": {
                                "p": 0.25
                            }
                        }
                    ]
                }
            },
            {
                "id": "decoder_upsample3",
                "class": "Upsample",
                "arguments": {
                    "scale_factor": 2
                }
            },
            {
                "id": "decoder_concat2",
                "class": "Concatenate"
            },
            {
                "id": "decoder_lvl2",
                "class": "CNN",
                "operation": {
                    "class": "SeparableConv1d"
                },
                "arguments": {
                    "channels": [
                        96,
                        32,
                        32
                    ],
                    "regularization": [
                        {
                            "class": "LeakyReLU"
                        },
                        {
                            "class": "BatchNorm1d",
                            "arguments": {
                                "num_features": "update"
                            }
                        },
                        {
                            "class": "Dropout1d",
                            "arguments": {
                                "p": 0.25
                            }
                        }
                    ]
                }
            },
            {
                "id": "decoder_upsample2",
                "class": "Upsample",
                "arguments": {
                    "scale_factor": 2
                }
            },
            {
                "id": "decoder_concat1",
                "class": "Concatenate"
            },
            {
                "id": "decoder_lvl1",
                "class": "CNN",
                "operation": {
                    "class": "SeparableConv1d"
                },
                "arguments": {
                    "channels": [
                        48,
                        16,
                        16,
                        3
                    ],
                    "regularization": [
                        {
                            "class": "LeakyReLU"
                        },
                        {
                            "class": "BatchNorm1d",
                            "arguments": {
                                "num_features": "update"
                            }
                        },
                        {
                            "class": "Dropout1d",
                            "arguments": {
                                "p": 0.25
                            }
                        }
                    ],
                    "regularize_extrema": false
                }
            },
            {
                "id": "sigmoid",
                "class": "Sigmoid"
            }
        ]
    }
}